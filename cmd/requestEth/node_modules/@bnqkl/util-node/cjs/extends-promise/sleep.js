"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.unsleep = exports.sleep = void 0;
const SLEEP_TASK_TI_WM = new WeakMap();
const sleep = (ms, onresolve) => {
    let ti;
    if (ms <= 0) {
        ms = 1;
    }
    const task = new Promise((resolve) => (ti = setTimeout(() => {
        SLEEP_TASK_TI_WM.delete(task);
        resolve();
    }, ms))).then(onresolve);
    SLEEP_TASK_TI_WM.set(task, ti);
    return task;
};
exports.sleep = sleep;
const unsleep = (task) => {
    const ti = SLEEP_TASK_TI_WM.get(task);
    if (ti !== undefined) {
        SLEEP_TASK_TI_WM.delete(task);
        clearTimeout(ti);
    }
};
exports.unsleep = unsleep;
